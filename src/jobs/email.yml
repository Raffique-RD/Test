description: >
  This job takes the generated reports store in workspace and sends them to SSCI client via email as an attachment.

parameters:
  to:
    type: string
    description: User's email address

docker:
  - image: cimg/base:2023.01

steps:
  - attach_workspace:
      at: .
  - run: |
        cloc=$(<cloc.txt)
        owasp=$(<owasp.json)
        curl --request POST 'https://www.cinotify.cc/api/notify' \
        -d "to=<<parameters.to>>&subject=Software Secured Cautus Inc Report &body=Repository Scan Report
        
        --CLOC Report-- 
        $cloc

        --OWASP Report Link-- 
        $owasp "